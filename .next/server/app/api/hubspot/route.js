"use strict";(()=>{var e={};e.id=99,e.ids=[99],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32936:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>h,patchFetch:()=>f,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>l,staticGenerationAsyncStorage:()=>d});var r={};s.r(r),s.d(r,{PATCH:()=>u,POST:()=>i});var o=s(49303),n=s(88716),a=s(60670);async function i(e){try{let t=await e.json(),{nombre:s,email:r,telefono:o,mensaje:n,aceptaComunicaciones:a,aceptaPolitica:i,flowAnswers:u={}}=t,p=Object.entries(u).map(([e,t])=>`Paso ${e}: ${t}`).join("\n"),c=`${n}

--- Respuestas del flujo ---
${p}`,d=await fetch("https://api.hubapi.com/crm/v3/objects/contacts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${process.env.HUBSPOT_TOKEN}`},body:JSON.stringify({properties:{email:r,firstname:s,phone:o,servicio:t.servicio,hubspot_owner_id:"83531397",hs_lead_status:"NEW",unidad_de_negocio:"Posting",canal_de_llegada:"P\xe1gina web",mensaje:c,he_leido_y_acepto_la_politica_de_tratamiento_de_datos_personales:i?"true":"false"}})}),l=null;if(d.ok)return l=(await d.json()).id,new Response(JSON.stringify({success:!0,contactId:l}),{status:200});if(409===d.status){let e=(await d.text()).match(/Existing ID: (\d+)/);if(e)return l=e[1],new Response(JSON.stringify({success:!0,contactId:l}),{status:200})}let h=await d.text();return new Response(JSON.stringify({success:!1,error:h}),{status:500})}catch(e){return console.error("Error interno HubSpot:",e),new Response(JSON.stringify({success:!1,error:e.message}),{status:500})}}async function u(e){try{let{contactId:t,properties:s}=await e.json();if(!t)return new Response(JSON.stringify({success:!1,error:"Falta el contactId"}),{status:400});if(!s||"object"!=typeof s)return new Response(JSON.stringify({success:!1,error:"Las propiedades no son v\xe1lidas"}),{status:400});let r=await fetch(`https://api.hubapi.com/crm/v3/objects/contacts/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${process.env.HUBSPOT_TOKEN}`},body:JSON.stringify({properties:s})}),o=await r.json();if(!r.ok)return console.error("âŒ Error PATCH HubSpot:",o),new Response(JSON.stringify({success:!1,error:o}),{status:r.status});return new Response(JSON.stringify({success:!0,result:o}),{status:200})}catch(e){return console.error("\uD83D\uDD25 Error interno en PATCH:",e),new Response(JSON.stringify({success:!1,error:e.message}),{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/hubspot/route",pathname:"/api/hubspot",filename:"route",bundlePath:"app/api/hubspot/route"},resolvedPagePath:"C:\\Users\\fe.osorio\\Documents\\Paginas\\pagina-posting\\src\\app\\api\\hubspot\\route.js",nextConfigOutput:"",userland:r}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:l}=p,h="/api/hubspot/route";function f(){return(0,a.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:d})}},49303:(e,t,s)=>{e.exports=s(30517)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948],()=>s(32936));module.exports=r})();